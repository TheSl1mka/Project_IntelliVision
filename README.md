# <center> Кластеризация изображений транспортных средств

<center> <img src=https://i.ibb.co/t8DvkyB/smart-city-image-1.jpg align="right" width="300"/> </center>
<center> <img src=https://i.ibb.co/qYkWNVh/smart-city-image-3.jpg align="right" width="300"/> </center>


Один из ключевых проектов IntelliVision — Smart City/Transportation, система, обеспечивающая безопасность дорожного движения и более эффективную работу парковок. С помощью Smart City/Transportation можно контролировать сигналы светофоров и соблюдение ограничений скорости, определять виды транспортных средств, распознавать номерные знаки, считать автомобили и людей.

В основе всех перечисленных возможностей проекта лежит CV (Computer Vision, компьютерное зрение). Чтобы их реализовать, компания использует модели, для обучения которых применяются огромные размеченные датасеты с изображениями транспортных средств. Однако система работает в режиме реального времени и с каждым днём данных становится всё больше. Алгоритм нуждается в постоянной модернизации и должен учитывать множество факторов.

Для модификации и повышения эффективности системы Smart City/Transportation команде необходимо автоматизировать определение дополнительных параметров авто на изображении:

* тип автомобиля (кузова),
* ракурс снимка (вид сзади/спереди),
* цвет автомобиля,
* другие характеристики.

Также необходимо автоматизировать поиск выбросов в данных (засветы и блики на изображениях, изображения, на которых отсутствуют автомобили и т. д.).

К сожалению, у компании нет комплексной модели, которая могла бы одновременно находить на изображении автомобиль и определять все нужные параметры. Её нужно построить, однако многокомпонентная разметка новых данных по всем этим параметрам — очень трудозатратное занятие, которое стоит больших денег.

При решении задачи разметки данных у команды возникла гипотеза, которая нуждается в исследовании.


**Гипотеза:** разметку исходных данных можно эффективно провести с помощью методов кластеризации. 


**В чём идея?**

*Давайте будем использовать небольшой набор моделей свёрточных нейронных сетей, обученных на различных датасетах и решающих различные задачи от классификации изображений по цвету до классификации типов транспортных средств, пропустим нашу базу изображений через каждую модель, но возьмём не выходной результат модели, а только промежуточное представление признаков (дескриптор), полученное на свёрточных слоях сети.*

*Выполним такую операцию для всех изображений из набора данных, на основе полученных дескрипторов кластеризуем изображения, проинтерпретируем полученные кластеры и попробуем найти в них необходимую информацию.*

Теперь, когда мы обсудили гипотезу, перейдём к постановке задачи.

<center> <img src=https://i.ibb.co/hLcBpZF/2023-03-27-12-11-17.png align="right" width="500"/> </center>

Обрабатывается [набор](https://www.kaggle.com/datasets/markhomeless/intellivision-case) из 416 314 изображений транспортных средств различных типов, цветов и снятых с разных ракурсов.

Команда IntelliVision уже обработала свой набор данных с помощью нескольких моделей глубокого обучения (свёрточных нейронных сетей) и получила четыре варианта вектора признаков (дескрипторов) для каждого изображения.

**Решаемая задача** — используя готовые дескрипторы, изображения разбиваются на кластеры несколькими алгоритмами кластеризации для всех вариантов дескрипторов, полученные результаты сравниваются на основе метрик, визуализаций плотностей кластеров и по тому, насколько хорошо интерпретируются кластеры.

Бизнес-задача: исследовать возможность применения алгоритмов кластеризации для разметки новых данных и поиска выбросов.

**Основные этапы решения задачи:**
1. Для каждого типа дескрипторов:
    * выполнена предобработка дескрипторов;
    * произведена кластеризация изображений на основе их дескрипторов, подобраны алгоритмы и параметры кластеризации по внутренним метрикам, а именно по индексу Калински — Харабаса (`calinski_harabasz_score`) и индексу Дэвиса — Болдина (`davies_bouldin_score`);
    * сделана визуализация полученных кластеров в 2D- или 3D-пространстве;
    * проинтерпретированы полученные кластеры.
2. Проведено сравнение полученных кластеризации для каждого типа дескрипторов (по метрикам, визуализации и результатам интерпретации).

**Приведена сводная таблица по результатам анализа построена**

## Использованные инструменты и библиотеки
* ipython (8.8.0)
* matplotlib (3.6.3)
* matplotlib-inline (0.1.6)
* numpy (1.24.3)
* pandas (1.5.3)
* pickleshare (0.7.5)
* plotly (5.12.0)
* scikit-learn (1.2.2)
* scipy (1.9.3)
* seaborn (0.12.2)
* tqdm (4.64.1)

